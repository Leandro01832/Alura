<!DOCTYPE html>
<html data-product="alura" class="" lang="pt-BR"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	

	
		



<!-- Page hiding snippet (recommended)  -->
<style>.async-hide { opacity: 0 !important} </style>
<script type="text/javascript" async="" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/analytics.js"></script><script async="" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/analytics.js"></script><script async="" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/gtm.js"></script><script>
	(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
	h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
	(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
	})(window,document.documentElement,'async-hide','dataLayer',4000,
		{'GTM-TN542JN':true});
</script>

<!-- Google Tag Manager -->
<script>
	(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer', 'GTM-TN542JN');
</script>
<!-- End Google Tag Manager -->


	<script type="text/javascript">
        dataLayer.push({
            'tipoPagina': 'Aula',
            'curso': 'Gulp: automação de tarefas front-end'
        });
	</script>

	

	<title>Gulp: Aula 2 - Atividade 2 Integridade do projeto | Alura - Cursos online de tecnologia</title>
	
	<link rel="shortcut icon" href="https://cursos.alura.com.br/assets/images/alura/favicon.ico">
	
	<link href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/css.css" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.gstatic.com/">

	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/video-js.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/silvermine-videojs-quality-selector.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/prettify.css">

	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/base.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/formattedText.css">
	
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/container.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/classPage.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/menuSettings.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskProgress.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskMessageInfo.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/alternativeList.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskFeedback.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/markdown.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/finishSection.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/phrase.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/hqexplanation.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/openquestion.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/textcontent.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/video.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/singlechoice.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/music.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/multiplechoice.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/videodialog.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/fillintheblank.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/speakingpractice.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/pronunciationpractice.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/repetition.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/genericVideo.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/projectSubmit.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/extraContentTask.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskContent.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskButtons.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/markdownEditor.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/audioPlayer.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/notes.css">
	
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/dark-mode.css">
	<link rel="stylesheet" href="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/taskFeedbackAnswer.css">


	<style type="text/css">
		.task:before, .video-js .vjs-play-progress {
			background-color: #2A7AE4;
		}
	</style>


	<script async="" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/hotjar-1638253.js"></script><script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/sha256.js"></script><script async="" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/modules.js" charset="utf-8"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style></head>
<body>


	
<!-- Google Tag Manager (noscript) -->
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TN542JN"
				  height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->




<section class="task menu--inactive" data-allow-answer="true" data-task-section-exam="false" data-task-type="hqexplanation" data-task-id="12011" data-author-id="437065" data-course-code="gulp" data-section-name="Integridade do projeto" data-section-id="3371" data-section-number="2" data-domain="cursos.alura.com.br" data-hasfeedbackanswer="false" data-url-prefix="/">
	<section class="task-body">
		
		<header class="task-body-header">
			<div class="container">
				<h1 class="task-body-header-title">
					
					
					<svg class="task-body-header-title-svg" aria-label="Atividade de Explicação">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
					</svg>
					<small>02</small>
					<span class="task-body-header-title-text"> Integridade do projeto</span>
				</h1>
				
					<div class="task-body-header-actions">
						<a href="https://cursos.alura.com.br/course/gulp/task/12011/next" aria-hidden="true" class="task-actions-button task-actions-button-next task-submit">Próxima Atividade</a>
					</div>
				
			</div>
		</header>
		<div class="task-body__wrapper">
			



<section class="class-notes">
    <div class="class-notes-content">
        <h2 class="class-notes-title">Meu caderno do curso (beta)</h2>
        <p class="class-notes-description">Este é seu caderno de 
anotações aqui na Alura. Todo o seu conteúdo fica vísivel apenas para 
você. Próximos passos para essa funcionalidade  no nosso<a href="https://suporte.alura.com.br/article/308-meu-caderno-como-funciona" class="class-notes-faq-link">FAQ</a></p>
        <textarea name="text" id="courseNotebook-text" class="class-notes-text" cols="30" rows="10"></textarea>
        <div class="class-notes-save-wrapper">
            <span>
                <p class="class-notes-saved-text" aria-hidden="true" style="display: none">Notas salvas</p>
            </span>
            <span class="class-notes-save-button-wrapper">
                <button class="class-notes-save-button" data-save-text="Salvar caderno" data-saving-text="Salvando">
                   Salvar caderno</button>
            </span>
        </div>
        <button class="class-notes-close-button"></button>
    </div>
</section>
			<main class="task-body-main container" data-should-warn="false">
				







	
		




<section class="hqExplanation" id="task-content">
	<div class="container">
	






<div class="settings">
	<button type="button" class="settings-button" aria-label="Configurações">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<span class="settings-box-title"></span>
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo noturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://cursos.alura.com.br/suggestions/new/gulp/12011/question">Sugerir alteração</a></li>
					
				
			
			
		</ul>
	</div>
</div>

		<div class="formattedText" data-external-links="">
			<p>Começando deste ponto? Você pode fazer o <a href="https://s3.amazonaws.com/caelum-online-public/gulp/stages/02-capitulo.zip" rel="nofollow noopener" target="_blank">DOWNLOAD</a> completo do projeto do capítulo anterior e continuar seus estudos a partir deste capítulo. Dentro da pasta <strong>projeto</strong>, não esqueça de executar no terminal o comando <strong>npm install</strong> para baixar novamente todas as dependências.</p>
<h2>Processos destrutivos</h2>
<p>Muito bem! Aprendemos a automatizar nossa primeira tarefa, a 
minificação de imagens. Que tal rodarmos nossa tarefa mais uma vez para 
vermos se tudo continua funcionando? No terminal:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp build</span><span class="pun">-</span><span class="pln">img</span></code></pre>
<p>Nenhum mensagem de erro é exibida, porém não houve minificação alguma:</p>
<pre class="prettyprint"><code><span class="typ">Starting</span><span class="pln"> </span><span class="str">'build-img'</span><span class="pun">...</span><span class="pln">
</span><span class="typ">Finished</span><span class="pln"> </span><span class="str">'build-img'</span><span class="pln"> after </span><span class="lit">10</span><span class="pln"> ms
gulp</span><span class="pun">-</span><span class="pln">imagemin</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Minified</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> images </span><span class="pun">(</span><span class="pln">saved </span><span class="lit">0</span><span class="pln"> B </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0</span><span class="pun">%)</span></code></pre>
<p>Não houve minificação porque as imagens já foram minificadas quando rodamos pela primeira vez nossa tarefa. Mistério resolvido!</p>
<p>Agora, antes de passarmos para a próxima tarefa, vou "dar uma de design" e retocarei o banner <code>projeto/img/destaque-home.png</code> abrindo-a no editor de imagens padrão da nossa plataforma. Vamos deixá-la mais clara:</p>
<p><img src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/imagem-gamma.png" alt="A past dist, cópia da pasta src"></p>
<p>Pronto, agora só rodarmos nossa tarefa mais uma vez:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp build</span><span class="pun">-</span><span class="pln">img</span></code></pre>
<p>Vejamos o resultado no console:</p>
<pre class="prettyprint"><code><span class="pun">[</span><span class="lit">11</span><span class="pun">:</span><span class="lit">40</span><span class="pun">:</span><span class="lit">15</span><span class="pun">]</span><span class="pln"> </span><span class="typ">Starting</span><span class="pln"> </span><span class="str">'build-img'</span><span class="pun">...</span><span class="pln">
</span><span class="pun">[</span><span class="lit">11</span><span class="pun">:</span><span class="lit">40</span><span class="pun">:</span><span class="lit">15</span><span class="pun">]</span><span class="pln"> </span><span class="typ">Finished</span><span class="pln"> </span><span class="str">'build-img'</span><span class="pln"> after </span><span class="lit">12</span><span class="pln"> ms
</span><span class="pun">[</span><span class="lit">11</span><span class="pun">:</span><span class="lit">40</span><span class="pun">:</span><span class="lit">19</span><span class="pun">]</span><span class="pln"> gulp</span><span class="pun">-</span><span class="pln">imagemin</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Minified</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> images </span><span class="pun">(</span><span class="pln">saved </span><span class="lit">149.98</span><span class="pln"> kB </span><span class="pun">-</span><span class="pln"> </span><span class="lit">7.3</span><span class="pun">%)</span></code></pre>
<p>Curioso! Quando alteremos nossa imagem pelo editor de imagem o 
resultado final é uma imagem não otimizada, por isso nossa tarefa a 
otimizou. Fizemos uma simples alteração na imagem, mas se repetirmos 
esse processo diversas vezes? Cada vez mais a imagem perderá sua 
qualidade porque estaremos sempre trabalhando com uma imagem já 
otimizada. O problema aqui é a destrutividade do nosso processo, que 
modifica os arquivos originais.</p>
<h2>Lindando com processos destrutivos</h2>
<p>Uma maneira de resolver esse problema é guardando as imagens 
originais. Sempre que uma alteração for necessária elas serão utilizadas
 e o processo de minificação operará sobre uma cópia. A mesma lógica se 
aplica com todos os outros arquivos do projeto.</p>
<p>Olhando nosso projeto, temos a pasta  <code>src</code>. Vamos criar uma cópia desta pasta que chamaremos de <code>dist</code>. Essa pasta, a famosa pasta <code>distribuição</code>
 é aquela que será colocada no ar, sendo assim, qualquer otimização que 
fizermos seja de imagens ou qualquer outro arquivo será nos arquivos 
desta pasta e nunca nos originais.</p>
<p><img src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/pasta-dist.png" alt="A past dist, cópia da pasta src"></p>
<p>Agora, vamos alterar nossa tarefa <code>build-img</code> para considerar a pasta <code>dist</code>, preservando a pasta <code>src</code>:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">);</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Pronto! Quando rodarmos nossa task <code>build-img</code> no terminal, estaremos trabalhando com uma cópia da pasta <code>src</code>, preservando assim as imagens originais e qualquer outro arquivo que viermos a alterar.</p>
<p>Espere um pouco! E  se rodarmos nossa tarefa novamente? Teremos que apagar a pasta <code>dist</code> e copiar novamente a pasta <code>src</code>. Mas não é só isso, se adicionarmos mais uma imagem em <code>src/img</code> teremos que lembrar de copiar essa imagem para a pasta <code>dist</code>.
 Repare que estamos realizando todo esse processo manualmente e não é 
isso que queremos, certo? Vamos automatizar a tarefa que copia o 
conteúdo da pasta <code>src</code> para a pasta <code>dist</code>.</p>
<h2>Automatizando a cópia de arquivos</h2>
<p>Já aprendemos a criar um fluxo de leitura (origem) e um fluxo de 
escrita (destino). Que tal ligarmos um fluxo no outro diretamente? O 
resultado disso será uma cópia do conteúdo do fluxo de leitura para o 
fluxo de escrita, justamente o que precisamos. É claro, precisamos criar
 uma tarefa para isso que vamos chamar de <code>copy</code>:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">);</span><span class="pln">

</span><span class="com">// nova tarefa</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Tarefa criada, agora vamos testar no console:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp copy</span></code></pre>
<p>Funcionou! Recebemos a seguinte mensagem no terminal:</p>
<pre class="prettyprint"><code><span class="typ">Starting</span><span class="pln"> </span><span class="str">'copy'</span><span class="pun">...</span><span class="pln">
</span><span class="typ">Finished</span><span class="pln"> </span><span class="str">'copy'</span><span class="pln"> after </span><span class="lit">9.17</span><span class="pln"> ms</span></code></pre>
<p>A pasta <code>dist</code> foi criada, porém temos um problema. O seu conteúdo deveria ser o conteúdo da pasta <code>src</code>, mas o que a pasta <code>dist</code> contém é a pasta <code>src</code>. Para resolvermos isso, precisamos alterar nosso fluxo de leitura para copiar o conteúdo da pasta <code>projeto/src</code> e não a pasta em si:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">);</span><span class="pln">

</span><span class="com">// alterando nossa task</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Usamos o padrão <code>**</code> para indicarmos que queremos copiar todas as pastas e <code>*</code> para indicar que queremos todos os arquivos dessa pasta. Isso é o que chamamos de <strong>glob pattern</strong>. Vamos testar mais uma vez:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp copy</span></code></pre>
<p>Excelente, ele copiou todo o conteúdo da pasta <code>projeto/src</code> para dentro de <code>dist</code>.</p>
<h2>Precisamos apagar antes de copiar</h2>
<p>A pasta <code>src</code> que havia sido copiada indevidamente ainda continua lá. Podemos resolver isso facilmente apagando a pasta <code>projeto/dist/src</code>, mas será isso a melhor solução? </p>
<p>Para complicar ainda mais, vamos apagar uma imagem do projeto 
original. Não é incomum adicionarmos e removermos imagens.  Se 
executarmos nossa task <code>copy</code> ele copiará todo o conteúdo de <code>src</code>, perfeito, mas como não apagamos a pasta <code>dist</code> antes de copiar, a imagem apagada na pasta original ainda estará em <code>dist</code>.</p>
<p>Nesse caso, quem deve ser o nosso fluxo de origem é a pasta <code>projeto\dist</code>,
 mas não queremos simplesmente gravá-la em outro lugar através de um 
fluxo de escrita, queremos é apagá-la. Para essa tarefa não rotineira, 
existe um plugin do Gulp com essa finalidade o <strong><a href="https://github.com/peter-vilja/gulp-clean" rel="nofollow noopener" target="_blank">gulp-clean</a></strong>.</p>
<p>Já aprendemos que é através do do npm executado no terminal que 
instalamos plugins do Gulp, que nada mais são do que módulos do Node.js.
 Vamos lá? Em nosso terminal:</p>
<pre class="prettyprint"><code><span class="pln">npm install gulp</span><span class="pun">-</span><span class="pln">clean@0</span><span class="pun">.</span><span class="lit">3.1</span><span class="pln"> </span><span class="pun">--</span><span class="pln">save</span><span class="pun">-</span><span class="pln">dev</span></code></pre>
<p>Como já vimos, a instalação desse módulo criará a pasta <code>node_modules/gulp-clean</code> e como usamos <code>--save-dev</code> ele será adicionado como dependência em nosso arquivo <code>package.json</code>.</p>
<p>Agora, em nosso <code>gulpfile.js</code>, vamos importar o módulo através da função <code>require</code> e para nossa comodidade armazená-lo em uma variável de nome curto chamada <code>clean</code>:</p>
<pre class="prettyprint"><code><span class="com">// importando o módulo del</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">clean </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-clean'</span><span class="pun">);</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Excelente. E agora? A tarefa de copiar é diferente da tarefa de apagar é por isso que criaremos uma nossa tarefa chamada <code>clean</code>:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">clean </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-clean'</span><span class="pun">);</span><span class="pln">


gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

</span><span class="com">// a nova tarefa clean</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Será que funciona? Vamos rodar primeiro a tarefa <code>clean</code> e logo em seguida a tarefa <code>copy</code>:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp clean
npm run gulp copy</span></code></pre>
<p>Perfeito! Funcionou! Primeiro ele apaga e depois copia.</p>
<h2>Tarefas e suas dependências</h2>
<p>Nosso treinamento é de automação de tarefas e sabemos que tudo que é 
feito pelo ser humano esta sujeito a erros. Certo? E se alguém esquecer 
de rodar a tarefa clean antes da copy, ou pior, inverter a ordem? Será 
que há alguma maneira de executarmos as duas tarefas de uma só vez? Sim.
 </p>
<p>Podemos indicar em uma tarefa qual é sua dependência, isto é, qual tarefa deve ser executada antes. Vamos alterar nossa task <code>copy</code> que depende da task <code>clean</code>:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">clean </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-clean'</span><span class="pun">);</span><span class="pln">

</span><span class="com">// adicionando clean como dependência da tarefa copy</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'clean'</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Veja que antes da função de callback, passamos um array, uma lista 
que contém todas as tarefas que desejamos executar antes. Será que 
funciona? Vamos agora executar apenas a task <strong>copy</strong>:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp copy</span></code></pre>
<p>Não funcionou e ainda exibiu o seguinte erro:</p>
<pre class="prettyprint"><code><span class="pln">events</span><span class="pun">.</span><span class="pln">js</span><span class="pun">:</span><span class="lit">85</span><span class="pln">
      </span><span class="kwd">throw</span><span class="pln"> er</span><span class="pun">;</span><span class="pln"> </span><span class="com">// Unhandled 'error' event</span><span class="pln">
            </span><span class="pun">^</span><span class="pln">
</span><span class="typ">Error</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Unable</span><span class="pln"> to </span><span class="kwd">delete</span><span class="pln"> </span><span class="str">"/Users/flavioalmeida/Desktop/projeto/dist"</span><span class="pln"> file </span><span class="pun">(</span><span class="pln">ENOTEMPTY</span><span class="pun">,</span><span class="pln"> rmdir </span><span class="str">'/Users/flavioalmeida/Desktop/projeto/dist'</span><span class="pun">).</span></code></pre>
<p>O que está acontecendo? A tarefa <code>copy</code> não esperou a tarefa <code>clean</code>
 terminar, mesmo adicionando-a como dependência. Para resolvermos esse 
problema, vamos lançar mão de um termo mais apropriado para a palavra 
fluxo, usaremos o termo <strong>stream</strong>. Quando combinamos 
streams, o resultado final é um novo stream. Por exemplo, poderíamos ter
 guardado o stream final em uma variável:</p>
<pre class="prettyprint"><code><span class="com">// não entra em nenhum lugar, apenas um exemplo</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> stream </span><span class="pun">=</span><span class="pln"> gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Se não retornarmos um stream, então o resultado assíncrono de cada 
tarefa não será aguardado por quem a chamou, inclusive por nenhuma de 
suas tarefas dependentes. Retornando uma stream:</p>
<pre class="prettyprint"><code><span class="com">// não entra em nenhum lugar, apenas um exemplo</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> stream </span><span class="pun">=</span><span class="pln"> gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Bom, agora vamos alterar pra valer nosso código, mas retornando o stream diretamente, sem guardar em uma variável:</p>
<pre class="prettyprint"><code><span class="com">// gulpfile.js</span><span class="pln">
</span><span class="com">// código anterior omitido</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span><span class="com">// código posterior omitido</span></code></pre>
<p>Vamos testar para ver se realmente a tarefa <code>copy</code> aguardou a tarefa <code>clean</code> terminar?</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp copy</span></code></pre>
<p>Funcionou! A tarefa copy só foi executada depois da conclusão da tarefa clean. </p>
<pre class="prettyprint"><code><span class="typ">Starting</span><span class="pln"> </span><span class="str">'clean'</span><span class="pun">...</span><span class="pln">
</span><span class="typ">Finished</span><span class="pln"> </span><span class="str">'clean'</span><span class="pln"> after </span><span class="lit">35</span><span class="pln"> ms
</span><span class="typ">Starting</span><span class="pln"> </span><span class="str">'copy'</span><span class="pun">...</span><span class="pln">
</span><span class="typ">Finished</span><span class="pln"> </span><span class="str">'copy'</span><span class="pln"> after </span><span class="lit">4.35</span><span class="pln"> ms</span></code></pre>
<p>Excelente, agora apenas um comando no terminal apaga e copia os nossos arquivos.</p>
<p>Então, que tal fazermos todo o processo? Copiar, apagar e otimizar as
 imagens? Opa! Mas se ele tentar otimizar as imagens antes de copiar 
nossos arquivos? Que tal adicionarmos <code>build-img</code> também como dependência de <code>copy</code>?</p>
<pre class="prettyprint"><code><span class="com">// código anterior omitido</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'build-img'</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span><span class="com">// código posterior omitido</span></code></pre>
<p>Temos um erro!</p>
<pre class="prettyprint"><code><span class="pln"> </span><span class="kwd">throw</span><span class="pln"> er</span><span class="pun">;</span><span class="pln"> </span><span class="com">// Unhandled 'error' event</span></code></pre>
<p>Veja que temos um problema aqui. A tarefa <code>build-img</code> só deve ser processada quando <code>copy</code> e todas as suas dependências forem executadas. Cometemos um erro colocando <code>build-img</code> como dependência de <code>copy</code>, é o contrário! Vamos alterar nosso script. Inclusive, vamos retornar o stream da tarefa copy, porque a tarefa <code>build-img</code> só pode ser executada depois da tarefa <code>copy</code> completar:</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> gulp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">imagemin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-imagemin'</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">,</span><span class="pln">clean </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'gulp-clean'</span><span class="pun">);</span><span class="pln">

</span><span class="com">// removida a dependência de build-img</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'copy'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'clean'</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'src/**/*'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'clean'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">clean</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

</span><span class="com">// adicionando a dependência copy</span><span class="pln">
gulp</span><span class="pun">.</span><span class="pln">task</span><span class="pun">(</span><span class="str">'build-img'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'copy'</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  gulp</span><span class="pun">.</span><span class="pln">src</span><span class="pun">(</span><span class="str">'dist/img/**/*'</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">imagemin</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">pipe</span><span class="pun">(</span><span class="pln">gulp</span><span class="pun">.</span><span class="pln">dest</span><span class="pun">(</span><span class="str">'dist/img'</span><span class="pun">));</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Agora é só testar e verificar o resultado:</p>
<pre class="prettyprint"><code><span class="pln">npm run gulp build</span><span class="pun">-</span><span class="pln">img</span></code></pre>
<p>Perfeito, as tarefas <code>clean</code>, <code>copy</code> e <code>build-img</code>
 são executadas. Veja que todas as tarefas são executadas uma por vez, 
porque nesse contexto não faz sentido que sejam executadas em paralelo (<code>build-img</code> depende de <code>copy</code> que depende de <code>clean</code>)
 Ainda recebemos a mensagem de 0% de minificação de imagens, mas isso 
era esperado. Precisamos recuperar os arquivos originais do projeto que 
foram modificados anteriormente. Volte ao projeto do capítulo anterior e
 copie as imagens e teste novamente.</p>
<p>Chegou a hora dos exercícios!</p>

		</div>
	</div>
</section>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

				
					






	
	
		<section class="task-actions">
			<div class="container">
				






    
    <a href="https://cursos.alura.com.br/forum/curso-gulp/exercicio-integridade-do-projeto/12011/novo" class=" task-actions-button task-actions-button-forum" target="_blank">Discutir no Forum</a>



				
				
				
					<a href="https://cursos.alura.com.br/course/gulp/task/12011/next" class="task-actions-button task-body-actions-button task-actions-button-next">Próxima Atividade</a>
				
			</div>
		</section>
	


				
			</main>
		</div>
	</section>
	


















<button title="Abrir menu/Fechar menu" aria-label="Abrir menu/Fechar menu" type="button" class="openMenu-button task-body-button openMenu-button--inactive"></button>

<aside class="task-menu" style="position: fixed; transform: translateY(-36.4px);">
	<section class="task-menu-header">
		<button title="Abrir menu" aria-label="Abrir menu" type="button" class="openMenu-button task-menu-button openMenu-button--inactive"></button>
		<div class="task-menu-header-info">
			<a class="task-menu-header-info-title" href="https://cursos.alura.com.br/course/gulp" title="Ir para página do curso">
				
					
					
						<img src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/gulp.svg" alt="ícone Gulp: automação de tarefas front-end" class="task-menu-header-info-title-icon " width="37.5px" height="37.5px">
					
				
				<h2 class="task-menu-header-info-title-text">Gulp: automação de tarefas front-end</h2>
			</a>
			
				<div class="task-menu-header-info-progress">
					
					<span class="task-menu-header-info-progress-percentage ">24%</span>
					<span class="task-menu-header-info-progress-bar" style="background-image: linear-gradient(to right, #9de482, #9de482 24%, transparent 24%);"></span>
				</div>
			
		</div>
	</section>
	
	<div class="task-menu-others task-menu-notes">
		<button class="task-menu-others-link class-notes-button" title="Abrir caderno">Abrir caderno</button>
	</div>

	<section class="task-menu-section">
		<div class="task-menu-section-title">
			<span class="task-menu-section-title-number ">Aula<strong>02</strong>
				<span>de 07</span></span>
			<h3 class="task-menu-section-title-text">
				Integridade do projeto
			</h3>
		</div>
	</section>
	<nav class="task-menu-nav">
		<h2 class="task-menu-nav-title">
			Atividades
			<span>2 de 9</span>
		</h2>
		<ul class="task-menu-nav-list">
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12010" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
						<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Vídeo concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">01</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Vídeo 1">
							Vídeo 1
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para o Vídeo">22min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item task-menu-nav-item--selected">
					<a href="https://cursos.alura.com.br/course/gulp/task/12011" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
						<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Explicação concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">02</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Integridade do projeto">
							Integridade do projeto
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12012" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">03</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Processos destrutivos">
							Processos destrutivos
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12013" class="task-menu-nav-item-link task-menu-nav-item-link-SINGLE_CHOICE">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Única escolha não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#SINGLE_CHOICE"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">04</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Copiando arquivos certos no local correto">
							Copiando arquivos certos no local correto
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12014" class="task-menu-nav-item-link task-menu-nav-item-link-SINGLE_CHOICE">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Única escolha não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#SINGLE_CHOICE"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">05</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Apagando arquivos">
							Apagando arquivos
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12015" class="task-menu-nav-item-link task-menu-nav-item-link-SINGLE_CHOICE">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Única escolha não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#SINGLE_CHOICE"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">06</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Dependências entre tarefas">
							Dependências entre tarefas
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12016" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">07</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Onde está  o erro?">
							Onde está  o erro?
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/12017" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">08</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Colocando em prática">
							Colocando em prática
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/gulp/task/39922" class="task-menu-nav-item-link task-menu-nav-item-link-TEXT_CONTENT">
						
						
						<svg class="task-menu-nav-item-svg " aria-label="Atividade de Sem Resposta do Aluno não concluída">
							
								
								<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#TEXT_CONTENT"></use>
							
							
						
					</svg>
					<span class="task-menu-nav-item-number">09</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Arquivos do projeto atual">
							Arquivos do projeto atual
						</span>
						
					</span></a>
				</li>
			
			
		</ul>
	</nav>
	<section class="task-menu-sections">
		<h2 class="task-menu-sections-title">
			Aulas
		</h2>
		<select class="task-menu-sections-select" onchange="location.href='/course/gulp/section/'+this.value+'/tasks';">
			
				<option value="3355">01. O peso das imagens</option>
			
				<option value="3371" selected="selected">02. Integridade do projeto</option>
			
				<option value="3379">03. Lidando com latência e banda</option>
			
				<option value="3418">04. Atacando repetições invisíveis</option>
			
				<option value="3419">05. Antecipando erros do futuro</option>
			
				<option value="3420">06. Combatendo o Prefix HELL!</option>
			
				<option value="3421">07. Usar pré-processador dá trabalho. Será?</option>
			
		</select>
	</section>
	<section class="task-menu-others">
		<h2 class="task-menu-others-title ">
			Outros Links
		</h2>
		<a href="https://cursos.alura.com.br/forum/curso-gulp/todos" class="task-menu-others-link task-menu-others-link-forum" title="Ir para o fórum do curso">Fórum</a>
		<a href="https://cursos.alura.com.br/dashboard" class="task-menu-others-link task-menu-others-link-curso" title="Ir para a página principal">Trocar Curso</a>

	</section>
	<section class="task-menu-footer">
		<a class="task-menu-footer-user" href="https://cursos.alura.com.br/user/perinng" title="Ir para sua página de usuário">
			<img src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/c5e9ead7f80a8ed147549256414ffdf9.webp" alt="Gravatar de PAULO FELIPE PERIN DA CRUZ" class="task-menu-footer-img" width="40px" height="40px">
			
				<p class="task-menu-footer-detalhes">
					<span class="task-menu-footer-detalhes-nome">PAULO FELIPE PERIN DA CRUZ</span>
					<span class="task-menu-footer-detalhes-xp">
						31.1k xp
					</span>
				</p>
			
			<input type="hidden" value="">
			<input type="hidden" value="">
		</a>
		<a href="https://cursos.alura.com.br/dashboard" class="task-menu-footer-logo">
			<img src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/icon-menu-alura.svg" alt="Logo da Alura" class="task-menu-footer-logo-image" title="Ir para a página principal" width="19px" height="32px">
		</a>
	</section>
</aside>



</section><div class="full-screen__panel" style="display: none;">
				<img id="full-screen__image" class="full-screen__image" src="" alt="">
				<div class="full-screen__actions">
				<button class="button buttonAction partitura-download">Anterior</button><button class="button buttonAction partitura-download">Sair</button><button class="button buttonAction partitura-download">Próximo</button></div> 
			</div>




	
		<!-- Hotjar Tracking Code for https://cursos.alura.com.br -->
		<script>
			(function(h,o,t,j,a,r){
				h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
				h._hjSettings={hjid:1638253,hjsv:6};
				a=o.getElementsByTagName('head')[0];
				r=o.createElement('script');r.async=1;
				r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
				a.appendChild(r);
			})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
		</script>
	

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/jquery-2.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/buttonToggle.js" async=""></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/sectionMenu.js" async=""></script>

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/marked.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/markdownEditor.js" async=""></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/caret.js" async=""></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/keydownWatchers.js" async=""></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/prettify.js" async=""></script>

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/preventsMultipleInteractions.js" async=""></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/assessment.js" async=""></script>

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/menuSettings.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/aria.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/ProjectSubmit.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/classPage.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/phrase.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/feedback.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/ExtraContentProgressRequest.js"></script>
	
	

	
	
	
	

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/partitura.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/audioProgress.js"></script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/audioPlayer.js"></script>

		

	

	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/darkMode.js">
	</script>

	
		



<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42101548-1', 'alura.com.br');

    
        ga('set', 'userId', '437065');
    

    ga('require', 'displayfeatures');
    
    ga('send', 'pageview');
    
    
</script>
	

	<script>new DarkModeToggler().refreshListener()</script>
	<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/ClassNotes.js">
	</script>
<script>
	new ClassNotes().refreshListeners();
</script>






<script src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/MarkdownProcessing.js"></script>
<script>
	new MarkdownProcessing("https://cursos.alura.com.br").onLoad();
</script><script type="text/javascript" id="">elements=document.querySelectorAll("input, select");elements.forEach(function(b,c){b.addEventListener("change",function(a){a=this.getAttribute("name");dataLayer.push({event:"gaEvent",eventCategory:"Formul\u00e1rios",eventAction:"Altera\u00e7\u00e3o",eventLabel:a})})});</script>
<script type="text/javascript" id="">var key="Think_Again45984$%";function log(a){console.log(a)}function getPars(){var a={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d});return a}function userId(a){a=sha256.hmac(key,a);dataLayer.push({event:"userId",userId:a})}var script=document.createElement("script");script.onload=function(){var a=getPars().e;a&&userId(a);a=document.querySelectorAll('[type\x3d"email"]');for(var b=0;b<a.length;b++)a[b].onchange=function(){userId(this.value)}};script.src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js";
document.head.appendChild(script);</script><iframe style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;" name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="Gulp%20Aula%202%20-%20Atividade%202%20Integridade%20do%20projeto%20Alura%20-%20Cursos%20online%20de%20tecnologia_arquivos/box-469cf41adb11dc78be68c1ae7f9457a4.html"></iframe></body></html>